#
#  cpld_warmstart_c48 test
#
export TEST_DESCR="Fully coupled FV3-CCPP-MOM6-CICE-CMEPS system - C48MX500 start from model initialization"

export CNTL_DIR="cpld_warmstart_c48"

export LIST_FILES="sfcf006.tile1.nc \
                   sfcf006.tile2.nc \
                   sfcf006.tile3.nc \
                   sfcf006.tile4.nc \
                   sfcf006.tile5.nc \
                   sfcf006.tile6.nc \
                   atmf006.tile1.nc \
                   atmf006.tile2.nc \
                   atmf006.tile3.nc \
                   atmf006.tile4.nc \
                   atmf006.tile5.nc \
                   atmf006.tile6.nc \
                   RESTART/coupler.res \
                   RESTART/fv_core.res.nc \
                   RESTART/fv_core.res.tile1.nc \
                   RESTART/fv_core.res.tile2.nc \
                   RESTART/fv_core.res.tile3.nc \
                   RESTART/fv_core.res.tile4.nc \
                   RESTART/fv_core.res.tile5.nc \
                   RESTART/fv_core.res.tile6.nc \
                   RESTART/fv_srf_wnd.res.tile1.nc \
                   RESTART/fv_srf_wnd.res.tile2.nc \
                   RESTART/fv_srf_wnd.res.tile3.nc \
                   RESTART/fv_srf_wnd.res.tile4.nc \
                   RESTART/fv_srf_wnd.res.tile5.nc \
                   RESTART/fv_srf_wnd.res.tile6.nc \
                   RESTART/fv_tracer.res.tile1.nc \
                   RESTART/fv_tracer.res.tile2.nc \
                   RESTART/fv_tracer.res.tile3.nc \
                   RESTART/fv_tracer.res.tile4.nc \
                   RESTART/fv_tracer.res.tile5.nc \
                   RESTART/fv_tracer.res.tile6.nc \
                   RESTART/phy_data.tile1.nc \
                   RESTART/phy_data.tile2.nc \
                   RESTART/phy_data.tile3.nc \
                   RESTART/phy_data.tile4.nc \
                   RESTART/phy_data.tile5.nc \
                   RESTART/phy_data.tile6.nc \
                   RESTART/sfc_data.tile1.nc \
                   RESTART/sfc_data.tile2.nc \
                   RESTART/sfc_data.tile3.nc \
                   RESTART/sfc_data.tile4.nc \
                   RESTART/sfc_data.tile5.nc \
                   RESTART/sfc_data.tile6.nc \
                   RESTART/MOM.res.nc \
                   RESTART/iced.2021-03-23-43200.nc \
                   RESTART/ufs.cpld.cpl.r.2021-03-23-43200.nc"

export_fv3
export_cpl

export SYEAR=2021
export SMONTH=03
export SDAY=23
export SHOUR=06
export SECS=`expr $SHOUR \* 3600`

export DAYS=0.25
export FHMAX=6

export FHROT=0
export RESTART_N=1
export RESTART_INTERVAL="${RESTART_N} -1"
export OUTPUT_FH="3 -1"
export FHZERO=3

export TASKS=$TASKS_cpl_c48
export INPES=$INPES_cpl_c48
export JNPES=$JNPES_cpl_c48
export THRD=$THRD_cpl_c48
export WRTTASK_PER_GROUP=$WPG_cpl_c48
export OUTPUT_GRID='cubed_sphere_grid'

export WAV_tasks=0
export CHM_tasks=0
OCN_tasks=$OCN_tasks_cpl_c48
ICE_tasks=$ICE_tasks_cpl_c48

# atm/ocn/ice resolution
export ATMRES=C48
export NPX=49
export NPY=49
export IMO=192
export JMO=94
export ATMTILESIZE=`expr $NPX - 1`

export OCNRES=500
export ICERES=5.00
export NX_GLB=72
export NY_GLB=35
export NPROC_ICE=$ICE_tasks
export CICE_DECOMP=slenderX1
export BLCKX=`expr $NX_GLB / $NPROC_ICE`
export BLCKY=$NY_GLB

# set component and coupling timesteps
export DT_ATMOS=1200
export DT_CICE=${DT_ATMOS}
export DT_DYNAM_MOM6=3600
export DT_THERM_MOM6=3600

# nems.configure
export coupling_interval_slow_sec=${DT_THERM_MOM6}
export coupling_interval_fast_sec=${DT_ATMOS}

# resolution dependent files
export MOM_INPUT=MOM_input_template_${OCNRES}
export MESHOCN_ICE=mesh.mx${OCNRES}.nc
export CICEGRID=grid_cice_NEMS_mx${OCNRES}.nc
export CICEMASK=kmtu_cice_NEMS_mx${OCNRES}.nc
export CHLCLIM=''
export FRUNOFF=''
export MOM6_RIVER_RUNOFF=False

export FNALBC="'C48.snowfree_albedo.tileX.nc'"
export FNALBC2="'C48.facsf.tileX.nc'"
export FNTG3C="'C48.substrate_temperature.tileX.nc'"
export FNVEGC="'C48.vegetation_greenness.tileX.nc'"
export FNVETC="'C48.vegetation_type.tileX.nc'"
export FNSOTC="'C48.soil_type.tileX.nc'"
export FNVMNC="'C48.vegetation_greenness.tileX.nc'"
export FNVMXC="'C48.vegetation_greenness.tileX.nc'"
export FNSLPC="'C48.slope_type.tileX.nc'"
export FNABSC="'C48.maximum_snow_albedo.tileX.nc'"
export FNSMCC="'global_soilmgldas.statsgo.t92.192.94.grb'"
export FNMSKH="'global_slmask.t62.192.94.grb'"

# resolution dependent setting
export CDMBWD=${CDMBWD_c48}
export DT_INNER=${DT_ATMOS}

# ATM warm start
export WARM_START=.true.
export MAKE_NH=.false.
export NA_INIT=0
export EXTERNAL_IC=.false.
export NGGPS_IC=.false.
export MOUNTAIN=.true.

# ICE warm start
export CICERUNTYPE=continue
export RUNTYPE=continue
export USE_RESTART_TIME=.true.

# MOM6 warm start
export MOM6_RESTART_SETTING=r

# no aero, no waves
export CPLCHM=.false.
export CPLWAV=.false.
export CPLWAV2ATM=.false.
export MOM6_USE_WAVES=False
export eps_imesh=4.0e-1

export DIAG_TABLE=diag_table_template
export FIELD_TABLE=field_table_thompson_noaero_tke
export NEMS_CONFIGURE=nems.configure.cpld_noaero_nowave.IN

export FV3_RUN=cpld_control_run.IN
