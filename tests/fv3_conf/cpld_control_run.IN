mkdir INPUT RESTART history MOM6_OUTPUT

if [[ $ATMRES == 'C96' ]]; then
  FV3_DIR=FV3_input_data
else
  FV3_DIR=FV3_input_data${ATMRES#C}
fi

ICERES="${OCNRES:0:1}.${OCNRES:1}"

# FV3 fixed input
cp    @[INPUTDATA_ROOT]/${FV3_DIR}/INPUT/aerosol.dat .
cp    @[INPUTDATA_ROOT]/${FV3_DIR}/INPUT/co2historicaldata_201*.txt .
cp    @[INPUTDATA_ROOT]/${FV3_DIR}/INPUT/sfc_emissivity_idx.txt .
cp    @[INPUTDATA_ROOT]/${FV3_DIR}/INPUT/solarconstant_noaa_an.txt .
if [ $OZ_PHYS_NEW = .T. ]; then
  cp  @[INPUTDATA_ROOT]/${FV3_DIR}/ozprdlos_2015_new_sbuv03_tclm15_nuchem.f77 ./global_o3prdlos.f77
elif [ $OZ_PHYS_OLD = .T. ]; then
  cp  @[INPUTDATA_ROOT]/${FV3_DIR}/INPUT/global_o3prdlos.f77 .
fi
cp    @[INPUTDATA_ROOT]/${FV3_DIR}/global_h2o_pltc.f77 ./global_h2oprdlos.f77
cp    @[INPUTDATA_ROOT]/${FV3_DIR}/*grb .
cp    @[INPUTDATA_ROOT]/${FV3_DIR}/@[FIELD_TABLE] ./field_table
cp    @[INPUTDATA_ROOT]/CPL_FIX/a@[ATMRES]o@[OCNRES]/grid_spec.nc ./INPUT
cp    @[INPUTDATA_ROOT]/${FV3_DIR}/INPUT/@[ATMRES]_grid*.nc ./INPUT
if [ ${FRAC_GRID_INPUT} = .F. ]; then
  cp  @[INPUTDATA_ROOT]/${FV3_DIR}/INPUT/oro_data*.nc ./INPUT
else
  cp  @[INPUTDATA_ROOT]/FV3_input_frac/@[ATMRES].mx@[OCNRES]_frac/oro_data*.nc ./INPUT
fi
cp    @[INPUTDATA_ROOT]/${FV3_DIR}/INPUT/grid_spec.nc ./INPUT/@[ATMRES]_mosaic.nc
cp    @[INPUTDATA_ROOT]/${FV3_DIR}/INPUT/gfs_ctrl.nc ./INPUT

# MOM6 fixed input
cp    @[INPUTDATA_ROOT]/MOM6_FIX/@[OCNRES]/* ./INPUT

# CICE fixed input
cp    @[INPUTDATA_ROOT]/CICE_FIX/@[OCNRES]/grid_cice_NEMS_mx@[OCNRES].nc .
cp    @[INPUTDATA_ROOT]/CICE_FIX/@[OCNRES]/kmtu_cice_NEMS_mx@[OCNRES].nc .
cp    @[INPUTDATA_ROOT]/CICE_FIX/@[OCNRES]/mesh.mx@[OCNRES].nc .

# No restart
if [ $WARM_START = .F. ]; then
  # ICs
  if [ ${FRAC_GRID_INPUT} = .F. ]; then
   cp  @[INPUTDATA_ROOT]/${FV3_DIR}/INPUT/sfc_data*.nc ./INPUT
   cp  @[INPUTDATA_ROOT]/${FV3_DIR}/INPUT/gfs_data*.nc ./INPUT
  else
   cp  @[INPUTDATA_ROOT]/FV3_input_frac/@[ATMRES].mx@[OCNRES]_frac/sfc_data*.nc ./INPUT
   cp  @[INPUTDATA_ROOT]/FV3_input_frac/@[ATMRES].mx@[OCNRES]_frac/gfs_data*.nc ./INPUT
  fi
  cp  @[INPUTDATA_ROOT]/MOM6_IC/MOM*.nc ./INPUT
  cp  @[INPUTDATA_ROOT]/CICE_IC/@[OCNRES]/cice_model_@[ICERES].res_2016100300.nc ./cice_model.res.nc

# Restart
else
  # Restart files
  cp ../${DEP_RUN}${RT_SUFFIX}/RESTART/coupler.res ./INPUT
  cp ../${DEP_RUN}${RT_SUFFIX}/RESTART/fv_*.nc ./INPUT
  cp ../${DEP_RUN}${RT_SUFFIX}/RESTART/sfc_data*.nc ./INPUT
  cp ../${DEP_RUN}${RT_SUFFIX}/RESTART/phy_data*.nc ./INPUT
  cp ../${DEP_RUN}${RT_SUFFIX}/RESTART/MOM*.nc ./INPUT

  # CMEPS restart and pointer files
  cp  ../${DEP_RUN}${RT_SUFFIX}/RESTART/ufs.cpld.cpl.r.2016-10-03-43200.nc .
  RFILE="ufs.cpld.cpl.r.2016-10-03-43200.nc"
  ls -1 ${RFILE}>rpointer.cpl

  # CICE restart and pointer files
  cp  ../${DEP_RUN}${RT_SUFFIX}/RESTART/iced.2016-10-03-43200.nc ./INPUT
  RFILE="iced.2016-10-03-43200.nc"
  ls -1 "./INPUT/"${RFILE}>ice.restart_file
fi
